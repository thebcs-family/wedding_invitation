<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Federico & Cecilia's Wedding</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap');
        
        :root {
            --primary-color: #f7fbec;
            --section-bg: #f8fff8;
            --button-color: #72999d;
        }
        
        body {
            font-family: 'Playfair Display', serif;
            background-color: var(--primary-color);
        }
        
        .header-image {
            height: 70vh;
            background-image: url('public/images/header-bg.jpg');
            background-size: cover;
            background-position: center;
            position: relative;
        }
        
        .header-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
        }
        
        .location-box {
            transition: all 0.3s ease;
            background: white;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            cursor: pointer;
        }
        
        .location-box:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .location-box:hover .location-content {
            background: var(--primary-color);
        }

        .location-date {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(114, 153, 157, 0.9);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s ease;
            opacity: 0;
        }

        .location-box:hover .location-date {
            opacity: 1;
        }

        .map-point {
            position: absolute;
            width: 1rem;
            height: 1rem;
            background: #ff4d4d;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .map-point:hover {
            transform: scale(1.5);
        }

        .map-tooltip {
            position: absolute;
            background: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: none;
            z-index: 10;
            width: 150px;
            font-size: 0.9rem;
        }

        .map-point:hover .map-tooltip {
            display: block;
        }

        .gallery-grid {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
        }

        .gallery-main-container {
            position: relative;
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .gallery-main {
            flex: 1;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            max-height: 500px;
            overflow: hidden;
        }

        .gallery-main img {
            max-width: 800px;
            max-height: 500px;
            width: auto;
            height: auto;
            object-fit: contain;
            border-radius: 0.5rem;
        }

        @media (max-width: 768px) {
            .gallery-main {
                max-height: 300px;
            }

            .gallery-main img {
                max-width: 100%;
                max-height: 300px;
            }
        }

        .gallery-navigation {
            position: absolute;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            pointer-events: none;
        }

        .gallery-arrow {
            background: var(--button-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0;
            pointer-events: auto;
            margin: 0 1rem;
        }

        .gallery-arrow img {
            width: 24px;
            height: 24px;
        }

        .gallery-arrow:hover {
            background: #b6cfa6;
            transform: scale(1.1);
        }

        .gallery-thumbnails {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            padding: 1rem 0;
        }

        .gallery-thumbnail {
            width: 150px;
            height: 100px;
            overflow: hidden;
            border-radius: 0.5rem;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .gallery-thumbnail {
                width: 80px;
                height: 60px;
            }
        }

        .gallery-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .gallery-thumbnail:hover img {
            transform: scale(1.1);
        }

        .message-item {
            background: white;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .message-author {
            font-weight: bold;
            color: var(--button-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .message-author::before {
            content: "♥";
            color: #b6cfa6;
        }

        .message-time {
            font-size: 0.8rem;
            color: #666;
        }

        .language-toggle {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: #e0f0e0;
            color: var(--button-color);
            border: none;
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .calendar-container {
            background: white;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .calendar-header {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.5rem;
            margin-bottom: 1rem;
            text-align: center;
        }

        .calendar-day {
            padding: 0.5rem;
            border-radius: 0.25rem;
            min-width: 2rem;
            color: #222;
        }

        .calendar-day.sunday {
            color: #ff6b6b;
            font-weight: bold;
        }

        .calendar-day.saturday {
            color: #ff6b6b;
            font-weight: bold;
        }
        .calendar-day.highlight {
            background: #b6cfa6;
            color: #fff;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(114,153,157,0.10);
        }
        .countdown {
            font-size: 0.9rem;
            font-weight: bold;
            color: var(--button-color);
            margin-top: 1rem;
            text-align: center;
        }
        .countdown-text {
            font-size: 1.1rem;
            color: #72999d;
            margin-top: 0.5rem;
            text-align: center;
        }
        .gift-section {
            background: white;
            padding: 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .gift-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--button-color);
            margin-bottom: 1rem;
            text-align: center;
        }

        .gift-description {
            text-align: center;
            margin-bottom: 1.5rem;
            color: #666;
        }

        .gift-info {
            background: #f8f8f8;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .gift-info p {
            margin-bottom: 0.5rem;
        }

        .kakao-transfer-btn {
            background: #FFE812;
            color: #3A1D1D;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: bold;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 0 auto;
        }

        .kakao-transfer-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Kakao Map custom hide */
        #daumRoughmapContainer1745838966001 .wrap_controllers,
        #daumRoughmapContainer1745838966001 .wrap_mapinfo,
        #daumRoughmapContainer1745838966001 .wrap_roadview,
        #daumRoughmapContainer1745838966001 .wrap_btn,
        #daumRoughmapContainer1745838966001 .wrap_placeinfo {
            display: none !important;
        }
        #daumRoughmapContainer1745838966001 {
            width: 100% !important;
            height: 360px !important;
            min-height: 360px !important;
            max-width: 100% !important;
        }

        /* Kakao Share Preview Popup */
        .kakao-share-modal-bg {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.4);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .kakao-share-modal {
            background: #fff;
            border-radius: 1rem;
            box-shadow: 0 8px 32px rgba(0,0,0,0.18);
            padding: 2rem 1.5rem 1.5rem 1.5rem;
            max-width: 350px;
            width: 90vw;
            text-align: center;
            position: relative;
        }
        .kakao-share-modal img {
            width: 100%;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
        }
        .kakao-share-title {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .kakao-share-desc {
            color: #666;
            margin-bottom: 1rem;
        }
        .kakao-share-close {
            position: absolute;
            top: 0.5rem;
            right: 0.8rem;
            font-size: 1.5rem;
            color: #aaa;
            cursor: pointer;
        }
        .kakao-share-send-btn {
            background: #FFE812;
            color: #3A1D1D;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: bold;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }
        .kakao-share-send-btn:hover {
            background: #ffe000;
        }

        /* Floating Play Button */
        .music-play-btn {
            position: fixed;
            bottom: 32px;
            right: 32px;
            z-index: 1200;
            background: #b6cfa6;
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 16px rgba(0,0,0,0.12);
            cursor: pointer;
            transition: background 0.2s;
        }
        .music-play-btn:hover {
            background: #72999d;
        }
        .music-play-btn img {
            width: 32px;
            height: 32px;
        }

        /* Image Popup Modal */
        .image-popup-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .image-popup-content {
            max-width: 90vw;
            max-height: 90vh;
            position: relative;
        }

        .image-popup-content img {
            max-width: 100%;
            max-height: 90vh;
            object-fit: contain;
        }

        .image-popup-close {
            position: absolute;
            top: -40px;
            right: 0;
            color: white;
            font-size: 30px;
            cursor: pointer;
            background: none;
            border: none;
            padding: 5px;
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header class="header-image flex items-center justify-center overflow-hidden">
        <div class="header-overlay"></div>
        <div class="relative z-10 text-center px-4">
            <h1 class="text-7xl md:text-6xl font-bold mb-5 text-white">Wedding Invitation</h1>
            <p class="text-5xl md:text-4xl font-light mb-4 text-white">Federico & Cecilia</p>
            <p class="text-3xl md:text-3xl text-white">Save the Date</p>
        </div>
    </header>

    <!-- World Map Section -->
    <section class="py-16 px-4" style="background-color: var(--section-bg);">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-4xl text-center mb-12">Our Journey</h2>
            
            <div class="mb-12 relative">
                <div class="bg-white p-4 rounded-lg shadow-lg">
                    <img
                        src="public/images/world-map.png"
                        alt="World Map with our locations"
                        class="w-full h-auto rounded-lg"
                    />
                </div>
                
                <!-- Map Points -->
                <div class="map-point" style="top: 44%; right: 17.5%;">
                    <div class="map-tooltip">
                        <p class="font-bold">Daejeon, Korea</p>
                        <p class="text-sm">June 14, 2025</p>
                    </div>
                </div>
                <div class="map-point" style="bottom: 25%; right: 67%;">
                    <div class="map-tooltip">
                        <p class="font-bold">La Paz, Bolivia</p>
                        <p class="text-sm">Coming Soon</p>
                    </div>
                </div>
                <div class="map-point" style="bottom: 55.5%; left: 51.5%;">
                    <div class="map-tooltip">
                        <p class="font-bold">Bologna, Italy</p>
                        <p class="text-sm">Coming Soon</p>
                    </div>
                </div>
            </div>

            <!-- Locations Grid -->
            <div class="flex flex-col md:flex-row gap-8">
                <div class="location-box flex-1" onclick="scrollToSection('wedding-korea')">
                    <div class="h-64 overflow-hidden relative">
                        <img src="public/images/korea.jpg" alt="Korea" class="w-full h-full object-cover">
                        <div class="location-date">June 14, 2025</div>
                    </div>
                    <div class="location-content p-6">
                        <h3 class="text-2xl font-bold mb-2">Daejeon, Korea</h3>
                        <p class="text-gray-600">Where our love story started</p>
                    </div>
                </div>
                
                <div class="location-box flex-1">
                    <div class="h-64 overflow-hidden relative">
                        <img src="public/images/bolivia.jpg" alt="Bolivia" class="w-full h-full object-cover">
                        <div class="location-date">Coming Soon</div>
                    </div>
                    <div class="location-content p-6">
                        <h3 class="text-2xl font-bold mb-2">La Paz, Bolivia</h3>
                        <p class="text-gray-600">Cecilia's hometown</p>
                    </div>
                </div>
                
                <div class="location-box flex-1">
                    <div class="h-64 overflow-hidden relative">
                        <img src="public/images/italy.jpg" alt="Italy" class="w-full h-full object-cover">
                        <div class="location-date">Coming Soon</div>
                    </div>
                    <div class="location-content p-6">
                        <h3 class="text-2xl font-bold mb-2">Bologna, Italy</h3>
                        <p class="text-gray-600">Federico's hometown</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Wedding Details Section -->
    <section class="py-16 px-4">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-4xl text-center mb-12">Wedding in Korea</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                <!-- Invitation Message -->
                <div class="bg-white p-8 rounded-lg shadow-lg">
                    <h3 class="text-2xl mb-6 text-center">Our Invitation</h3>
                    <p class="text-gray-700 leading-relaxed text-center">
                        Though we come from different corners of the world,
                        our paths crossed, and love found its way.
                        Now, hand in hand, we begin a new journey as one.
                        We invite you to celebrate our love
                        and happiness in our new beginning. ♡
                    </p>
                </div>

                <!-- Wedding Details -->
                <div class="bg-white p-8 rounded-lg shadow-lg relative">
                    <button class="language-toggle" onclick="toggleLanguage()" id="lang-toggle">Kor</button>
                    <h3 class="text-2xl mb-6 text-center">Wedding Details</h3>
                    <div class="text-center">
                        <div id="en-content">
                            <p class="text-xl mb-4">Saturday, June 14, 2025</p>
                            <p class="text-xl mb-4">4:30 PM</p>
                            <p class="mb-4">Hiel Place</p>
                            <p class="mb-4">15-4, Gwanjeo-nam-ro 12beon-gil</p>
                        </div>
                        <div id="ko-content" style="display: none;">
                            <p class="text-xl mb-4">2025년 6월 14일 토요일</p>
                            <p class="text-xl mb-4">오후 4시 30분</p>
                            <p class="mb-4">히엘플레이스</p>
                            <p class="mb-4">대전 서구 관저남로12번길 15-4 1층</p>
                        </div>
                    </div>
                </div>

                <!-- RSVP -->
                <div class="bg-white p-8 rounded-lg shadow-lg">
                    <h3 class="text-2xl mb-6 text-center">RSVP</h3>
                    <p class="text-center mb-4 text-gray-600">Please RSVP online and submit your response</p>
                    <div class="text-center">
                        <button
                            onclick="showRSVP()"
                            class="text-white px-8 py-3 rounded-lg transition-colors text-lg"
                            style="background-color: var(--button-color);"
                        >
                            RSVP Now
                        </button>
                    </div>
                </div>
            </div>

            <!-- Naver Map -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                <div class="md:col-span-2">
                    <div class="bg-white p-4 rounded-lg shadow-lg">
                        <!-- Kakao Map Embed Start -->
                        <div id="daumRoughmapContainer1745838966001" class="root_daum_roughmap root_daum_roughmap_landing"></div>
                        <script charset="UTF-8" class="daum_roughmap_loader_script" src="https://ssl.daumcdn.net/dmaps/map_js_init/roughmapLoader.js"></script>
                        <script charset="UTF-8">
                            new daum.roughmap.Lander({
                                "timestamp" : "1745838966001",
                                "key" : "2nutq",
                                "mapWidth" : "100%",
                                "mapHeight" : "360"
                            }).render();
                        </script>
                        <!-- Kakao Map Embed End -->
                    </div>
                </div>
                <div class="calendar-container">
                    <div class="calendar-header">June 2025</div>
                    <div class="calendar-grid">
                        <div class="calendar-day sunday">Su</div>
                        <div class="calendar-day">Mo</div>
                        <div class="calendar-day">Tu</div>
                        <div class="calendar-day">We</div>
                        <div class="calendar-day">Th</div>
                        <div class="calendar-day">Fr</div>
                        <div class="calendar-day saturday">Sa</div>
                        <div class="calendar-day sunday">1</div>
                        <div class="calendar-day">2</div>
                        <div class="calendar-day">3</div>
                        <div class="calendar-day">4</div>
                        <div class="calendar-day">5</div>
                        <div class="calendar-day">6</div>
                        <div class="calendar-day saturday">7</div>
                        <div class="calendar-day sunday">8</div>
                        <div class="calendar-day">9</div>
                        <div class="calendar-day">10</div>
                        <div class="calendar-day">11</div>
                        <div class="calendar-day">12</div>
                        <div class="calendar-day">13</div>
                        <div class="calendar-day highlight">14</div>
                        <div class="calendar-day sunday">15</div>
                        <div class="calendar-day">16</div>
                        <div class="calendar-day">17</div>
                        <div class="calendar-day">18</div>
                        <div class="calendar-day">19</div>
                        <div class="calendar-day">20</div>
                        <div class="calendar-day saturday">21</div>
                        <div class="calendar-day sunday">22</div>
                        <div class="calendar-day">23</div>
                        <div class="calendar-day">24</div>
                        <div class="calendar-day">25</div>
                        <div class="calendar-day">26</div>
                        <div class="calendar-day">27</div>
                        <div class="calendar-day saturday">28</div>
                        <div class="calendar-day sunday">29</div>
                        <div class="calendar-day">30</div>
                    </div>
                    <div class="countdown" id="countdown"></div>
                    <div class="countdown-text" id="countdown-text"></div>
                </div>
            </div>

            <!-- Gallery Section -->
            <div class="bg-white p-8 rounded-lg shadow-lg mb-12">
                <h3 class="text-2xl mb-6 text-center">Our Gallery</h3>
                <div class="gallery-grid">
                    <div class="gallery-main-container">
                        <div class="gallery-navigation">
                            <button class="gallery-arrow" onclick="showGalleryImage(currentGalleryIndex - 1)">
                                <img src="public/images/arrow_left.png" alt="Previous">
                            </button>
                            <button class="gallery-arrow" onclick="showGalleryImage(currentGalleryIndex + 1)">
                                <img src="public/images/arrow_right.png" alt="Next">
                            </button>
                        </div>
                        <div class="gallery-main" onclick="showImagePopup(document.getElementById('main-gallery-image').src)">
                            <img src="public/images/gallery/photo_1.png" alt="Main gallery image" id="main-gallery-image">
                        </div>
                    </div>
                    <div class="gallery-thumbnails">
                        <div class="gallery-thumbnail" onclick="changeMainImage('public/images/gallery/photo_1.png')">
                            <img src="public/images/gallery/photo_1.png" alt="Gallery thumbnail 1">
                        </div>
                        <div class="gallery-thumbnail" onclick="changeMainImage('public/images/gallery/photo_2.png')">
                            <img src="public/images/gallery/photo_2.png" alt="Gallery thumbnail 2">
                        </div>
                        <div class="gallery-thumbnail" onclick="changeMainImage('public/images/gallery/photo_3.png')">
                            <img src="public/images/gallery/photo_3.png" alt="Gallery thumbnail 3">
                        </div>
                        <div class="gallery-thumbnail" onclick="changeMainImage('public/images/gallery/photo_4.png')">
                            <img src="public/images/gallery/photo_4.png" alt="Gallery thumbnail 4">
                        </div>
                        <div class="gallery-thumbnail" onclick="changeMainImage('public/images/gallery/photo_5.png')">
                            <img src="public/images/gallery/photo_5.png" alt="Gallery thumbnail 5">
                        </div>
                        <div class="gallery-thumbnail" onclick="changeMainImage('public/images/gallery/photo_6.png')">
                            <img src="public/images/gallery/photo_6.png" alt="Gallery thumbnail 6">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Image Popup Modal -->
            <div id="imagePopupModal" class="image-popup-modal">
                <div class="image-popup-content">
                    <button class="image-popup-close" onclick="closeImagePopup()">&times;</button>
                    <img id="popupImage" src="" alt="Popup image">
                </div>
            </div>

            <!-- Gift Section -->
            <div class="gift-section">
                <h3 class="gift-title">축하의 마음 전하기</h3>
                <p class="gift-description">축하의 마음 담아 축의금을 전달해 보세요</p>
                <div class="gift-info">
                    <p><strong>Name:</strong> Federico Berto & Cecilia Callejas</p>
                    <p><strong>Bank Account:</strong> [Your Bank Account Details]</p>
                </div>
            </div>

            <!-- Messages Section -->
            <div class="bg-white p-8 rounded-lg shadow-lg">
                <h3 class="text-2xl mb-6 text-center">Messages from Our Guests</h3>
                <div id="messagesContainer" class="space-y-4 mb-8">
                    <!-- Messages will be dynamically added here -->
                </div>

                <h3 class="text-2xl mb-6 text-center">Leave a Message</h3>
                <form id="messageForm" class="space-y-4">
                    <div>
                        <label class="block text-gray-700 mb-2">Name</label>
                        <input
                            type="text"
                            name="name"
                            class="w-full px-4 py-2 border rounded-lg"
                            placeholder="Your name"
                            required
                        />
                    </div>
                    <div>
                        <label class="block text-gray-700 mb-2">Message</label>
                        <textarea
                            name="message"
                            class="w-full px-4 py-2 border rounded-lg"
                            rows="4"
                            placeholder="Your message"
                            required
                        ></textarea>
                    </div>
                    <div class="text-center">
                        <button
                            type="submit"
                            class="text-white px-8 py-3 rounded-lg transition-colors text-lg"
                            style="background-color: var(--button-color);"
                        >
                            Send Message
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- RSVP Modal -->
    <div id="rsvpModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white p-8 rounded-lg max-w-md w-full mx-4">
            <h3 class="text-2xl mb-6 text-center">RSVP Form</h3>
            <form class="space-y-4" onsubmit="handleRSVP(event)">
                <div>
                    <label class="block text-gray-700 mb-2">Name</label>
                    <input
                        type="text"
                        name="name"
                        class="w-full px-4 py-2 border rounded-lg"
                        placeholder="Your name"
                        required
                    />
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">Will you attend?</label>
                    <select name="attendance" class="w-full px-4 py-2 border rounded-lg" required>
                        <option value="yes">Yes, I will attend</option>
                        <option value="no">No, I cannot attend</option>
                    </select>
                </div>
                <div class="text-center text-sm text-gray-600 mb-4">
                    Please confirm your response
                </div>
                <div class="flex justify-end space-x-4 mt-6">
                    <button
                        type="button"
                        onclick="hideRSVP()"
                        class="px-4 py-2 border rounded-lg hover:bg-gray-100"
                    >
                        Cancel
                    </button>
                    <button
                        type="submit"
                        class="text-white px-4 py-2 rounded-lg"
                        style="background-color: var(--button-color);"
                    >
                        Submit
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="py-8 text-center">
        <div class="max-w-6xl mx-auto px-4">
            <h3 class="text-2xl mb-6">소식공유</h3>
            <button 
                onclick="shareKakao()"
                class="bg-yellow-400 text-white px-8 py-3 rounded-lg transition-colors text-lg mb-8"
            >
                KakaoTalk 공유
            </button>
            <p class="text-gray-600 mb-4">Thank you!</p>
            <div class="text-4xl" style="color: var(--button-color);">♥</div>
            <p class="text-gray-600 mt-8">Developed by Federico Berto & Cecilia Callejas</p>
        </div>
    </footer>

    <!-- Kakao Share Preview Modal -->
    <div id="kakaoShareModalBg" class="kakao-share-modal-bg" style="display:none;">
        <div class="kakao-share-modal">
            <span class="kakao-share-close" onclick="closeKakaoShareModal()">&times;</span>
            <img src="public/images/header-bg.jpg" alt="Preview">
            <div class="kakao-share-title">Federico &amp; Cecilia's Wedding</div>
            <div class="kakao-share-desc">Join us in celebrating on June 14, 2025</div>
            <button class="bg-yellow-400 text-white px-8 kakao-share-send-btn" onclick="sendKakaoShare()">전송하기</button>
        </div>
    </div>

    <!-- Background Music & Play Button -->
    <audio id="bgMusic" src="public/music/wedding.mp3" loop></audio>
    <button class="music-play-btn" id="musicPlayBtn" onclick="toggleMusic()">
        <img id="musicPlayIcon" src="public/images/play.png" alt="Play">
    </button>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>

    <script>
        // Initialize Firebase with configuration from secrets.js
        if (!firebase.apps.length) {
            firebase.initializeApp(window.FIREBASE_CONFIG);
            firebase.analytics();
        }
        const db = firebase.firestore();
        db.settings({
            timestampsInSnapshots: true,
            merge: true,
            cacheSizeBytes: firebase.firestore.CACHE_SIZE_UNLIMITED
        });

        // Enable offline persistence
        db.enablePersistence()
            .catch((err) => {
                if (err.code === 'failed-precondition') {
                    console.warn('Multiple tabs open, persistence can only be enabled in one tab at a time.');
                } else if (err.code === 'unimplemented') {
                    console.warn('The current browser does not support persistence.');
                }
            });

        // Test Firestore connection
        db.collection('messages').get()
            .then(() => console.log('Firestore connection successful'))
            .catch(error => console.error('Firestore connection error:', error));

        function showRSVP() {
            document.getElementById('rsvpModal').classList.remove('hidden');
            document.getElementById('rsvpModal').classList.add('flex');
        }

        function hideRSVP() {
            document.getElementById('rsvpModal').classList.add('hidden');
            document.getElementById('rsvpModal').classList.remove('flex');
        }

        function handleRSVP(event) {
            event.preventDefault();
            const form = event.target;
            const nameInput = form.querySelector('input[name="name"]');
            const attendanceInput = form.querySelector('select[name="attendance"]');
            
            if (!nameInput || !attendanceInput) {
                console.error('RSVP form inputs not found');
                return;
            }

            const rsvpData = {
                name: nameInput.value.trim(),
                attendance: attendanceInput.value,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            };

            // Validate inputs
            if (!rsvpData.name) {
                showNotification('Please enter your name', 'error');
                return;
            }

            db.collection('rsvps').add(rsvpData)
                .then(() => {
                    showNotification('Thank you for your RSVP!', 'success');
                    hideRSVP();
                    form.reset();
                })
                .catch(error => {
                    console.error('Error adding RSVP:', error);
                    showNotification('There was an error submitting your RSVP. Please try again.', 'error');
                });
        }

        // Handle message form submission
        document.getElementById('messageForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            // Get form values properly
            const nameInput = this.elements['name'];
            const messageInput = this.elements['message'];
            
            if (!nameInput || !messageInput) {
                console.error('Form inputs not found:', {
                    nameInput,
                    messageInput,
                    formElements: this.elements
                });
                return;
            }

            const messageData = {
                name: nameInput.value.trim(),
                message: messageInput.value.trim(),
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            };

            // Validate inputs
            if (!messageData.name || !messageData.message) {
                showNotification('Please fill in all fields', 'error');
                return;
            }

            console.log('Submitting message:', messageData);

            db.collection('messages').add(messageData)
                .then((docRef) => {
                    console.log('Message added with ID:', docRef.id);
                    showNotification('Thank you for your message!', 'success');
                    this.reset();
                })
                .catch(error => {
                    console.error('Error details:', {
                        code: error.code,
                        message: error.message,
                        details: error.details,
                        stack: error.stack
                    });
                    showNotification('There was an error submitting your message. Please try again.', 'error');
                });
        });

        // Add notification system
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <span class="notification-icon">${type === 'success' ? '✓' : '⚠'}</span>
                    <span class="notification-message">${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Add styles for the notification
            const style = document.createElement('style');
            style.textContent = `
                .notification {
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 15px 25px;
                    border-radius: 8px;
                    background: white;
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                    z-index: 1000;
                    animation: slideIn 0.3s ease-out;
                    max-width: 300px;
                }
                .notification.success {
                    border-left: 4px solid #4CAF50;
                }
                .notification.error {
                    border-left: 4px solid #f44336;
                }
                .notification-content {
                    display: flex;
                    align-items: center;
                    gap: 10px;
                }
                .notification-icon {
                    font-size: 20px;
                    font-weight: bold;
                }
                .notification.success .notification-icon {
                    color: #4CAF50;
                }
                .notification.error .notification-icon {
                    color: #f44336;
                }
                .notification-message {
                    color: #333;
                    font-size: 14px;
                }
                @keyframes slideIn {
                    from {
                        transform: translateX(100%);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
            `;
            document.head.appendChild(style);
            
            // Remove notification after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        console.log("Script loaded");

        // Gallery navigation logic
        const galleryImages = [
            'public/images/gallery/photo_1.png',
            'public/images/gallery/photo_2.png',
            'public/images/gallery/photo_3.png',
            'public/images/gallery/photo_4.png',
            'public/images/gallery/photo_5.png',
            'public/images/gallery/photo_6.png'
        ];
        let currentGalleryIndex = 0;

        function showGalleryImage(index) {
            if (index < 0) index = galleryImages.length - 1;
            if (index >= galleryImages.length) index = 0;
            currentGalleryIndex = index;
            const mainImage = document.getElementById('main-gallery-image');
            mainImage.src = galleryImages[index];
        }

        function changeMainImage(src) {
            const index = galleryImages.indexOf(src);
            if (index !== -1) {
                showGalleryImage(index);
            }
        }

        // Initialize gallery on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => {
            showGalleryImage(0);
            loadMessages();
            updateCountdown();
            setInterval(updateCountdown, 1000);
        });

        function toggleLanguage() {
            const enContent = document.getElementById('en-content');
            const koContent = document.getElementById('ko-content');
            const langToggle = document.getElementById('lang-toggle');

            if (enContent.style.display === 'none') {
                // Switch to English
                enContent.style.display = 'block';
                koContent.style.display = 'none';
                langToggle.textContent = 'Kor';
            } else {
                // Switch to Korean
                enContent.style.display = 'none';
                koContent.style.display = 'block';
                langToggle.textContent = 'Eng';
            }
        }

        function showImagePopup(src) {
            const modal = document.getElementById('imagePopupModal');
            const popupImage = document.getElementById('popupImage');
            popupImage.src = src;
            modal.style.display = 'flex';
        }

        function closeImagePopup() {
            document.getElementById('imagePopupModal').style.display = 'none';
        }

        // Close popup when clicking outside the image
        document.getElementById('imagePopupModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeImagePopup();
            }
        });

        // Close popup with Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeImagePopup();
            }
        });

        // Load messages
        function loadMessages() {
            const messagesContainer = document.getElementById('messagesContainer');
            
            db.collection('messages')
                .orderBy('timestamp', 'desc')
                .onSnapshot(snapshot => {
                    messagesContainer.innerHTML = '';
                    snapshot.forEach(doc => {
                        const message = doc.data();
                        const messageElement = document.createElement('div');
                        messageElement.className = 'message-item';
                        const date = message.timestamp ? new Date(message.timestamp.toDate()).toLocaleDateString() : 'Just now';
                        messageElement.innerHTML = `
                            <div class="message-header">
                                <div class="message-author">${message.name}</div>
                                <div class="message-time">${date}</div>
                            </div>
                            <div class="message-text">${message.message}</div>
                        `;
                        messagesContainer.appendChild(messageElement);
                    });
                }, error => {
                    console.error('Error loading messages:', error);
                    messagesContainer.innerHTML = '<div class="text-center text-gray-500">Error loading messages. Please try again later.</div>';
                });
        }

        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
        }

        function updateCountdown() {
            const weddingDate = new Date('2025-06-14T16:30:00');
            const now = new Date();
            const diff = weddingDate - now;

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);

            document.getElementById('countdown').innerHTML =
                `${days} days, ${hours} hours, ${minutes} minutes, ${seconds} seconds`;
        }

        function shareKakao() {
            // Show custom Kakao share preview modal
            document.getElementById('kakaoShareModalBg').style.display = 'flex';
        }

        function closeKakaoShareModal() {
            document.getElementById('kakaoShareModalBg').style.display = 'none';
        }

        function sendKakaoShare() {
            if (typeof Kakao === 'undefined') {
                alert('Kakao SDK is not loaded');
                return;
            }
            Kakao.Share.sendDefault({
                objectType: 'feed',
                content: {
                    title: `Federico & Cecilia's Wedding`,
                    description: 'Join us in celebrating our love on June 14, 2025',
                    imageUrl: window.location.origin + '/public/images/header-bg.jpg',
                    link: {
                        mobileWebUrl: window.location.href,
                        webUrl: window.location.href,
                    },
                },
                buttons: [
                    {
                        title: 'View Invitation',
                        link: {
                            mobileWebUrl: window.location.href,
                            webUrl: window.location.href,
                        },
                    },
                ],
            });
            closeKakaoShareModal();
        }

        // Background music play/pause logic
        let isMusicPlaying = false;
        function toggleMusic() {
            const audio = document.getElementById('bgMusic');
            const icon = document.getElementById('musicPlayIcon');
            if (audio.paused) {
                audio.play();
                icon.src = 'public/images/pause.png';
                isMusicPlaying = true;
            } else {
                audio.pause();
                icon.src = 'public/images/play.png';
                isMusicPlaying = false;
            }
        }

        // Initialize Kakao SDK with environment variable
        (function() {
            const script = document.createElement('script');
            script.src = 'https://developers.kakao.com/sdk/js/kakao.js';
            script.async = true;
            document.head.appendChild(script);
            
            script.onload = function() {
                Kakao.init(window.KAKAO_APP_KEY);
                console.log('Kakao SDK initialized');
            };
        })();

        console.log(document.querySelectorAll('.gallery-thumbnail img').length);
        console.log(document.getElementById('main'));
        console.log(window.galleryImages);

        document.getElementById('main-gallery-image')
    </script>
</body>
</html> 
